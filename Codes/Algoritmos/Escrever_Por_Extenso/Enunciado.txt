Escrever por extenso

Faça um programa de leia um valor com dígitos numéricos e escreve o equivalente valor por extenso em moeda corrente. Por exemplo: para o valor R$ 123,87 seria escrito (cento e vinte e sete reais e oitenta e sete centavos).

O programa deve finalizar quando for digitado o valor 0 (zero), sendo que somente valores entre 0 (zero) e R$ 9.999,99 serão aceitos.  Utilize funções em sua resposta.  Enviar somente arquivo fonte.